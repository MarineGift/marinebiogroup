"use strict";(()=>{var e={};e.id=936,e.ids=[936],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5315:e=>{e.exports=require("path")},286:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>N,patchFetch:()=>A,requestAsyncStorage:()=>j,routeModule:()=>w,serverHooks:()=>R,staticGenerationAsyncStorage:()=>h});var r={};s.r(r),s.d(r,{DELETE:()=>x,GET:()=>m,POST:()=>y,PUT:()=>f});var a=s(9303),n=s(8716),i=s(670),o=s(7070);let c=require("fs/promises");var u=s(5315),p=s.n(u);let g=[{id:1,title:"샘플 이미지 1",image:"/images/gallery/sample1.jpg",category:"프로젝트",description:"샘플 프로젝트 이미지입니다.",createdAt:"2024-01-01T00:00:00.000Z",updatedAt:"2024-01-01T00:00:00.000Z"},{id:2,title:"샘플 이미지 2",image:"/images/gallery/sample2.jpg",category:"회사",description:"회사 사무실 이미지입니다.",createdAt:"2024-01-02T00:00:00.000Z",updatedAt:"2024-01-02T00:00:00.000Z"}],l=3;async function d(e){try{let t=p().join(process.cwd(),"public","uploads","gallery");await (0,c.mkdir)(t,{recursive:!0});let s=Date.now(),r=e.name.replace(/[^a-zA-Z0-9.-]/g,"_"),a=`${s}-${r}`,n=p().join(t,a),i=await e.arrayBuffer(),o=Buffer.from(i);return await (0,c.writeFile)(n,o),`/uploads/gallery/${a}`}catch(e){throw console.error("File save error:",e),Error("파일 저장에 실패했습니다.")}}async function m(e){try{let{searchParams:t}=new URL(e.url),s=parseInt(t.get("page")||"1"),r=parseInt(t.get("limit")||"12"),a=t.get("category")||"",n=t.get("search")||"",i=g;a&&(i=i.filter(e=>e.category.toLowerCase()===a.toLowerCase())),n&&(i=i.filter(e=>e.title.toLowerCase().includes(n.toLowerCase())||e.description?.toLowerCase().includes(n.toLowerCase())));let c=i.length,u=Math.ceil(c/r),p=(s-1)*r,l=i.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()).slice(p,p+r),d=Array.from(new Set(g.map(e=>e.category)));return o.NextResponse.json({success:!0,data:l,pagination:{currentPage:s,totalPages:u,totalItems:c,itemsPerPage:r,hasNext:s<u,hasPrev:s>1},categories:d})}catch(e){return console.error("GET /api/gallery error:",e),o.NextResponse.json({success:!1,message:"갤러리를 가져오는데 실패했습니다."},{status:500})}}async function y(e){try{let t=await e.formData(),s=t.get("title"),r=t.get("category"),a=t.get("description")||"",n=t.get("image");if(!s||!r)return o.NextResponse.json({success:!1,message:"제목과 카테고리는 필수입니다."},{status:400});if(!n||!(n instanceof File))return o.NextResponse.json({success:!1,message:"이미지 파일이 필요합니다."},{status:400});if(!n.type.startsWith("image/"))return o.NextResponse.json({success:!1,message:"이미지 파일만 업로드 가능합니다."},{status:400});if(n.size>5242880)return o.NextResponse.json({success:!1,message:"파일 크기는 5MB를 초과할 수 없습니다."},{status:400});let i=await d(n),c={id:l++,title:s.trim(),category:r.trim(),description:a.trim(),image:i,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return g.push(c),o.NextResponse.json({success:!0,data:c,message:"갤러리 아이템이 성공적으로 추가되었습니다."})}catch(e){return console.error("POST /api/gallery error:",e),o.NextResponse.json({success:!1,message:"갤러리 아이템 추가에 실패했습니다."},{status:500})}}async function f(e){try{let t=await e.formData(),s=parseInt(t.get("id")),r=t.get("title"),a=t.get("category"),n=t.get("description")||"",i=t.get("image");if(!s||!r||!a)return o.NextResponse.json({success:!1,message:"ID, 제목, 카테고리는 필수입니다."},{status:400});let c=g.findIndex(e=>e.id===s);if(-1===c)return o.NextResponse.json({success:!1,message:"갤러리 아이템을 찾을 수 없습니다."},{status:404});let u=g[c].image;if(i&&i instanceof File){if(!i.type.startsWith("image/"))return o.NextResponse.json({success:!1,message:"이미지 파일만 업로드 가능합니다."},{status:400});if(i.size>5242880)return o.NextResponse.json({success:!1,message:"파일 크기는 5MB를 초과할 수 없습니다."},{status:400});u=await d(i)}return g[c]={...g[c],title:r.trim(),category:a.trim(),description:n.trim(),image:u,updatedAt:new Date().toISOString()},o.NextResponse.json({success:!0,data:g[c],message:"갤러리 아이템이 수정되었습니다."})}catch(e){return console.error("PUT /api/gallery error:",e),o.NextResponse.json({success:!1,message:"갤러리 아이템 수정에 실패했습니다."},{status:500})}}async function x(e){try{let{searchParams:t}=new URL(e.url),s=parseInt(t.get("id")||"0");if(!s)return o.NextResponse.json({success:!1,message:"유효하지 않은 ID입니다."},{status:400});let r=g.findIndex(e=>e.id===s);if(-1===r)return o.NextResponse.json({success:!1,message:"갤러리 아이템을 찾을 수 없습니다."},{status:404});let a=g.splice(r,1)[0];return o.NextResponse.json({success:!0,data:a,message:"갤러리 아이템이 삭제되었습니다."})}catch(e){return console.error("DELETE /api/gallery error:",e),o.NextResponse.json({success:!1,message:"갤러리 아이템 삭제에 실패했습니다."},{status:500})}}let w=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/gallery/route",pathname:"/api/gallery",filename:"route",bundlePath:"app/api/gallery/route"},resolvedPagePath:"D:\\0_프로그램개발\\Github\\marinebiogroup\\src\\app\\api\\gallery\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:j,staticGenerationAsyncStorage:h,serverHooks:R}=w,N="/api/gallery/route";function A(){return(0,i.patchFetch)({serverHooks:R,staticGenerationAsyncStorage:h})}}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[948,972],()=>s(286));module.exports=r})();