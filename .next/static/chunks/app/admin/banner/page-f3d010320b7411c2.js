(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[451],{3100:function(e,t,a){Promise.resolve().then(a.bind(a,5520))},5520:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return n}});var r=a(7437),s=a(2265),l=a(3145),i=a(6538);function n(){let[e,t]=(0,s.useState)([]),[a,n]=(0,s.useState)(1),[d,c]=(0,s.useState)(0),[o,x]=(0,s.useState)(0),[m]=(0,s.useState)(10),[p,u]=(0,s.useState)(!1),[h,b]=(0,s.useState)(""),[g,y]=(0,s.useState)(""),[j,v]=(0,s.useState)(""),[f,N]=(0,s.useState)(""),[w,k]=(0,s.useState)(!1),[C,D]=(0,s.useState)(null),[S,U]=(0,s.useState)({title:"",description:"",linkUrl:"",position:"main-top",isActive:!0,order:1,startDate:"",endDate:""}),[A,P]=(0,s.useState)(null),[E,L]=(0,s.useState)(""),[O,T]=(0,s.useState)(!1),I=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;u(!0),b("");try{let a=new URLSearchParams({page:e.toString(),limit:m.toString(),...g&&{position:g},...j&&{status:j},...f&&{search:f}}),r=await fetch("/api/admin/banners?".concat(a)),s=await r.json();s.success?(t(s.data),n(s.pagination.currentPage),c(s.pagination.totalPages),x(s.pagination.totalItems)):b("배너 데이터를 불러오는데 실패했습니다.")}catch(e){b("네트워크 오류가 발생했습니다."),console.error("Error fetching banners:",e)}finally{u(!1)}};(0,s.useEffect)(()=>{I(a)},[a,g,j,f]);let _=t=>{t?(D(t),U({title:t.title,description:t.description||"",linkUrl:t.linkUrl||"",position:t.position,isActive:t.isActive,order:t.order,startDate:t.startDate?new Date(t.startDate).toISOString().slice(0,16):"",endDate:t.endDate?new Date(t.endDate).toISOString().slice(0,16):""}),L(t.imageUrl)):(D(null),U({title:"",description:"",linkUrl:"",position:"main-top",isActive:!0,order:e.length+1,startDate:"",endDate:""}),L("")),P(null),k(!0)},F=async()=>{if(!S.title.trim()){alert("제목을 입력해주세요.");return}if(!C&&!A){alert("이미지를 선택해주세요.");return}T(!0);try{let e=new FormData;e.append("title",S.title),e.append("description",S.description),e.append("linkUrl",S.linkUrl),e.append("position",S.position),e.append("isActive",S.isActive.toString()),e.append("order",S.order.toString()),e.append("startDate",S.startDate),e.append("endDate",S.endDate),A&&e.append("image",A);let t=C?"/api/admin/banners/".concat(C.id):"/api/admin/banners";(await fetch(t,{method:C?"PUT":"POST",body:e})).ok?(alert(C?"배너가 수정되었습니다.":"배너가 추가되었습니다."),k(!1),I(a)):alert("저장 중 오류가 발생했습니다.")}catch(e){console.error("Save error:",e),alert("저장 중 오류가 발생했습니다.")}finally{T(!1)}},R=async e=>{if(confirm("정말 삭제하시겠습니까?"))try{(await fetch("/api/admin/banners/".concat(e),{method:"DELETE"})).ok?(alert("배너가 삭제되었습니다."),I(a)):alert("삭제 중 오류가 발생했습니다.")}catch(e){console.error("Delete error:",e),alert("삭제 중 오류가 발생했습니다.")}},M=async(e,t)=>{try{(await fetch("/api/admin/banners/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({isActive:!t})})).ok?I(a):alert("상태 변경에 실패했습니다.")}catch(e){console.error("Toggle error:",e),alert("상태 변경 중 오류가 발생했습니다.")}},H=async(e,t)=>{try{(await fetch("/api/admin/banners/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({order:t})})).ok?I(a):alert("순서 변경에 실패했습니다.")}catch(e){console.error("Order update error:",e),alert("순서 변경 중 오류가 발생했습니다.")}},J=e=>({style:({"main-top":"bg-red-100 text-red-800","main-middle":"bg-blue-100 text-blue-800","main-bottom":"bg-green-100 text-green-800",sidebar:"bg-purple-100 text-purple-800",footer:"bg-gray-100 text-gray-800"})[e],label:({"main-top":"메인 상단","main-middle":"메인 중간","main-bottom":"메인 하단",sidebar:"사이드바",footer:"푸터"})[e]}),Z=(e,t)=>{let a=new Date,r=e?new Date(e):null,s=t?new Date(t):null;return r&&r>a?{status:"scheduled",label:"예약됨",color:"text-yellow-600"}:s&&s<a?{status:"expired",label:"만료됨",color:"text-red-600"}:{status:"active",label:"진행중",color:"text-green-600"}};return(0,r.jsxs)("div",{className:"p-6 max-w-7xl mx-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"배너 관리"}),(0,r.jsx)("button",{onClick:()=>_(),className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600",children:"새 배너 추가"})]}),(0,r.jsxs)("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"검색"}),(0,r.jsx)("form",{onSubmit:e=>{e.preventDefault(),n(1),I(1)},children:(0,r.jsx)("input",{type:"text",value:f,onChange:e=>N(e.target.value),placeholder:"제목으로 검색...",className:"w-full px-3 py-2 border border-gray-300 rounded-md"})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"위치"}),(0,r.jsxs)("select",{value:g,onChange:e=>{y(e.target.value),n(1)},className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,r.jsx)("option",{value:"",children:"전체"}),(0,r.jsx)("option",{value:"main-top",children:"메인 상단"}),(0,r.jsx)("option",{value:"main-middle",children:"메인 중간"}),(0,r.jsx)("option",{value:"main-bottom",children:"메인 하단"}),(0,r.jsx)("option",{value:"sidebar",children:"사이드바"}),(0,r.jsx)("option",{value:"footer",children:"푸터"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"상태"}),(0,r.jsxs)("select",{value:j,onChange:e=>{v(e.target.value),n(1)},className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,r.jsx)("option",{value:"",children:"전체"}),(0,r.jsx)("option",{value:"active",children:"활성"}),(0,r.jsx)("option",{value:"inactive",children:"비활성"})]})]}),(0,r.jsx)("div",{className:"flex items-end",children:(0,r.jsx)("button",{onClick:()=>I(a),className:"w-full bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600",children:"새로고침"})})]}),p&&(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),(0,r.jsx)("p",{className:"mt-2 text-gray-600",children:"로딩 중..."})]}),h&&(0,r.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:h}),!p&&!h&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,r.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,r.jsx)("thead",{className:"bg-gray-50",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"이미지"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"제목"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"위치"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"상태"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"기간"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"통계"}),(0,r.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"순서"}),(0,r.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"액션"})]})}),(0,r.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>{let t=Z(e.startDate,e.endDate);return(0,r.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("div",{className:"relative w-20 h-12",children:(0,r.jsx)(l.default,{src:e.imageUrl,alt:e.title,fill:!0,className:"object-cover rounded"})})}),(0,r.jsx)("td",{className:"px-6 py-4",children:(0,r.jsxs)("div",{className:"max-w-xs",children:[(0,r.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:e.title}),e.description&&(0,r.jsx)("div",{className:"text-sm text-gray-500 truncate",children:e.description}),e.linkUrl&&(0,r.jsx)("div",{className:"text-xs text-blue-500 truncate",children:(0,r.jsx)("a",{href:e.linkUrl,target:"_blank",rel:"noopener noreferrer",children:e.linkUrl})})]})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(J(e.position).style),children:J(e.position).label})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,r.jsx)("button",{onClick:()=>M(e.id,e.isActive),className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.isActive?"활성":"비활성"}),(0,r.jsx)("span",{className:"text-xs ".concat(t.color),children:t.label})]})}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.startDate&&(0,r.jsxs)("div",{children:["시작: ",new Date(e.startDate).toLocaleDateString()]}),e.endDate&&(0,r.jsxs)("div",{children:["종료: ",new Date(e.endDate).toLocaleDateString()]}),!e.startDate&&!e.endDate&&(0,r.jsx)("div",{className:"text-gray-400",children:"기간 제한 없음"})]}),(0,r.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[(0,r.jsxs)("div",{children:["클릭: ",e.clickCount.toLocaleString()]}),(0,r.jsxs)("div",{children:["노출: ",e.impressionCount.toLocaleString()]}),e.impressionCount>0&&(0,r.jsxs)("div",{className:"text-xs text-blue-600",children:["CTR: ",(e.clickCount/e.impressionCount*100).toFixed(2),"%"]})]}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,r.jsx)("input",{type:"number",value:e.order,onChange:t=>H(e.id,parseInt(t.target.value)),className:"w-16 px-2 py-1 border border-gray-300 rounded text-center text-sm",min:"1"})}),(0,r.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,r.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,r.jsx)("button",{onClick:()=>_(e),className:"text-blue-600 hover:text-blue-900",children:"편집"}),(0,r.jsx)("button",{onClick:()=>R(e.id),className:"text-red-600 hover:text-red-900",children:"삭제"})]})})]},e.id)})})]})}),0===e.length&&(0,r.jsx)("div",{className:"text-center py-12",children:(0,r.jsx)("p",{className:"text-gray-500",children:"배너가 없습니다."})}),(0,r.jsx)(i.Z,{currentPage:a,totalPages:d,onPageChange:e=>{n(e)},showInfo:!0,itemsPerPage:m,totalItems:o})]}),w&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h2",{className:"text-xl font-bold",children:C?"배너 편집":"새 배너 추가"}),(0,r.jsx)("button",{onClick:()=>k(!1),className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"제목 *"}),(0,r.jsx)("input",{type:"text",value:S.title,onChange:e=>U(t=>({...t,title:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"배너 제목"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"설명"}),(0,r.jsx)("textarea",{value:S.description,onChange:e=>U(t=>({...t,description:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",rows:3,placeholder:"배너 설명 (선택사항)"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"링크 URL"}),(0,r.jsx)("input",{type:"url",value:S.linkUrl,onChange:e=>U(t=>({...t,linkUrl:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"https://..."})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"위치"}),(0,r.jsxs)("select",{value:S.position,onChange:e=>U(t=>({...t,position:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,r.jsx)("option",{value:"main-top",children:"메인 상단"}),(0,r.jsx)("option",{value:"main-middle",children:"메인 중간"}),(0,r.jsx)("option",{value:"main-bottom",children:"메인 하단"}),(0,r.jsx)("option",{value:"sidebar",children:"사이드바"}),(0,r.jsx)("option",{value:"footer",children:"푸터"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"순서"}),(0,r.jsx)("input",{type:"number",value:S.order,onChange:e=>U(t=>({...t,order:parseInt(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",min:"1"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"시작일"}),(0,r.jsx)("input",{type:"datetime-local",value:S.startDate,onChange:e=>U(t=>({...t,startDate:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1",children:"종료일"}),(0,r.jsx)("input",{type:"datetime-local",value:S.endDate,onChange:e=>U(t=>({...t,endDate:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium mb-1",children:["배너 이미지 ",C?"":"*"]}),(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a){if(!a.type.startsWith("image/")){alert("이미지 파일만 업로드 가능합니다.");return}P(a),L(URL.createObjectURL(a))}},className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]}),E&&(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-2",children:"미리보기"}),(0,r.jsx)("div",{className:"relative w-full h-48 border rounded",children:(0,r.jsx)(l.default,{src:E,alt:"Preview",fill:!0,className:"object-contain rounded"})})]}),(0,r.jsx)("div",{children:(0,r.jsxs)("label",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",checked:S.isActive,onChange:e=>U(t=>({...t,isActive:e.target.checked})),className:"mr-2"}),"활성화"]})})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,r.jsx)("button",{onClick:()=>k(!1),className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50",disabled:O,children:"취소"}),(0,r.jsx)("button",{onClick:F,disabled:O||!S.title.trim()||!C&&!A,className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",children:O?"저장 중...":C?"수정":"추가"})]})]})})]})}},6538:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var r=a(7437),s=a(2265);function l(e){let{currentPage:t,totalPages:a,onPageChange:l,showInfo:i=!0,itemsPerPage:n=10,totalItems:d=0}=e,[c,o]=(0,s.useState)([]);(0,s.useEffect)(()=>{o((()=>{let e=[];if(a<=5)for(let t=1;t<=a;t++)e.push(t);else{let r=Math.max(1,t-Math.floor(2.5)),s=Math.min(a,r+5-1);s-r+1<5&&(r=Math.max(1,s-5+1));for(let t=r;t<=s;t++)e.push(t)}return e})())},[t,a]);let x=e=>{e>=1&&e<=a&&e!==t&&l(e)};return a<=1?null:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4 mt-6",children:[i&&(0,r.jsxs)("div",{className:"text-sm text-gray-600",children:["페이지 ",t," / ",a,d>0&&(0,r.jsxs)("span",{className:"ml-2",children:["(총 ",d.toLocaleString(),"개 항목, 페이지당 ",n,"개)"]})]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("button",{onClick:()=>{1!==t&&l(1)},disabled:1===t,className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"첫 페이지",children:"\xab\xab"}),(0,r.jsx)("button",{onClick:()=>{t>1&&l(t-1)},disabled:1===t,className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"이전 페이지",children:"‹"}),c.length>0&&c[0]>1&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>x(1),className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50",children:"1"}),c[0]>2&&(0,r.jsx)("span",{className:"px-2 py-2 text-sm text-gray-400",children:"..."})]}),c.map(e=>(0,r.jsx)("button",{onClick:()=>x(e),className:"px-3 py-2 text-sm border rounded-md ".concat(e===t?"bg-blue-500 text-white border-blue-500":"border-gray-300 hover:bg-gray-50"),children:e},e)),c.length>0&&c[c.length-1]<a&&(0,r.jsxs)(r.Fragment,{children:[c[c.length-1]<a-1&&(0,r.jsx)("span",{className:"px-2 py-2 text-sm text-gray-400",children:"..."}),(0,r.jsx)("button",{onClick:()=>x(a),className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50",children:a})]}),(0,r.jsx)("button",{onClick:()=>{t<a&&l(t+1)},disabled:t===a,className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"다음 페이지",children:"›"}),(0,r.jsx)("button",{onClick:()=>{t!==a&&l(a)},disabled:t===a,className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"마지막 페이지",children:"\xbb\xbb"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,r.jsx)("span",{children:"페이지 이동:"}),(0,r.jsx)("input",{type:"number",min:"1",max:a,className:"w-16 px-2 py-1 border border-gray-300 rounded text-center",onKeyDown:e=>{if("Enter"===e.key){let t=parseInt(e.target.value);t>=1&&t<=a&&(x(t),e.target.value="")}},placeholder:t.toString()}),(0,r.jsxs)("span",{children:["/ ",a]})]})]})}}},function(e){e.O(0,[145,971,117,744],function(){return e(e.s=3100)}),_N_E=e.O()}]);