(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[372],{8298:function(e,t,s){Promise.resolve().then(s.bind(s,4664))},4664:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return r}});var l=s(7437),a=s(2265);function r(){let[e,t]=(0,a.useState)([]),[s,r]=(0,a.useState)(null),[i,n]=(0,a.useState)(!1),[d,c]=(0,a.useState)(""),[o,m]=(0,a.useState)(!1),[x,u]=(0,a.useState)(null),[h,p]=(0,a.useState)({title:"",url:"",parentId:"",order:1,isActive:!0,target:"_self",icon:"",description:""}),[b,g]=(0,a.useState)(!1),[j,v]=(0,a.useState)(null),[y,f]=(0,a.useState)({name:"",location:"header",isActive:!0}),[N,w]=(0,a.useState)(!1),k=async()=>{n(!0),c("");try{let e=await fetch("/api/admin/menus"),l=await e.json();l.success?(t(l.data),l.data.length>0&&!s&&r(l.data[0])):c("메뉴 데이터를 불러오는데 실패했습니다.")}catch(e){c("네트워크 오류가 발생했습니다."),console.error("Error fetching menus:",e)}finally{n(!1)}};(0,a.useEffect)(()=>{k()},[]);let C=(e,t)=>{if(e){var l;u(e),p({title:e.title,url:e.url,parentId:(null===(l=e.parentId)||void 0===l?void 0:l.toString())||"",order:e.order,isActive:e.isActive,target:e.target,icon:e.icon||"",description:e.description||""})}else{u(null);let e=(null==s?void 0:s.items.length)?Math.max(...s.items.map(e=>e.order)):0;p({title:"",url:"",parentId:(null==t?void 0:t.toString())||"",order:e+1,isActive:!0,target:"_self",icon:"",description:""})}m(!0)},S=e=>{e?(v(e),f({name:e.name,location:e.location,isActive:e.isActive})):(v(null),f({name:"",location:"header",isActive:!0})),g(!0)},I=async()=>{if(!h.title.trim()||!h.url.trim()){alert("제목과 URL은 필수입니다.");return}if(!s){alert("메뉴 그룹을 선택해주세요.");return}w(!0);try{let e={...h,parentId:h.parentId?parseInt(h.parentId):null,groupId:s.id},t=x?"/api/admin/menus/items/".concat(x.id):"/api/admin/menus/items";(await fetch(t,{method:x?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?(alert(x?"메뉴가 수정되었습니다.":"메뉴가 추가되었습니다."),m(!1),k()):alert("저장 중 오류가 발생했습니다.")}catch(e){console.error("Save error:",e),alert("저장 중 오류가 발생했습니다.")}finally{w(!1)}},A=async()=>{if(!y.name.trim()){alert("그룹명은 필수입니다.");return}w(!0);try{let e=j?"/api/admin/menus/groups/".concat(j.id):"/api/admin/menus/groups";(await fetch(e,{method:j?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)})).ok?(alert(j?"그룹이 수정되었습니다.":"그룹이 추가되었습니다."),g(!1),k()):alert("저장 중 오류가 발생했습니다.")}catch(e){console.error("Save error:",e),alert("저장 중 오류가 발생했습니다.")}finally{w(!1)}},E=async e=>{if(confirm("정말 삭제하시겠습니까? 하위 메뉴도 함께 삭제됩니다."))try{(await fetch("/api/admin/menus/items/".concat(e),{method:"DELETE"})).ok?(alert("메뉴가 삭제되었습니다."),k()):alert("삭제 중 오류가 발생했습니다.")}catch(e){console.error("Delete error:",e),alert("삭제 중 오류가 발생했습니다.")}},_=async e=>{if(confirm("정말 삭제하시겠습니까? 그룹에 속한 모든 메뉴가 삭제됩니다."))try{(await fetch("/api/admin/menus/groups/".concat(e),{method:"DELETE"})).ok?(alert("그룹이 삭제되었습니다."),r(null),k()):alert("삭제 중 오류가 발생했습니다.")}catch(e){console.error("Delete error:",e),alert("삭제 중 오류가 발생했습니다.")}},T=async(e,t)=>{try{(await fetch("/api/admin/menus/items/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({order:t})})).ok?k():alert("순서 변경에 실패했습니다.")}catch(e){console.error("Order update error:",e),alert("순서 변경 중 오류가 발생했습니다.")}},O=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=e.filter(e=>!e.parentId),a=e.filter(e=>e.parentId);return s.map(e=>(0,l.jsxs)("div",{className:"ml-".concat(4*t),children:[(0,l.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg mb-2 bg-white",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[e.icon&&(0,l.jsx)("span",{className:"text-lg",children:e.icon}),(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-medium",children:e.title}),(0,l.jsx)("div",{className:"text-sm text-gray-500",children:e.url}),e.description&&(0,l.jsx)("div",{className:"text-xs text-gray-400",children:e.description})]}),!e.isActive&&(0,l.jsx)("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded",children:"비활성"}),"_blank"===e.target&&(0,l.jsx)("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-600 rounded",children:"새창"})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("input",{type:"number",value:e.order,onChange:t=>T(e.id,parseInt(t.target.value)),className:"w-16 px-2 py-1 border border-gray-300 rounded text-center text-sm",min:"1"}),(0,l.jsx)("button",{onClick:()=>C(void 0,e.id),className:"text-green-600 hover:text-green-900 text-sm",children:"하위추가"}),(0,l.jsx)("button",{onClick:()=>C(e),className:"text-blue-600 hover:text-blue-900 text-sm",children:"편집"}),(0,l.jsx)("button",{onClick:()=>E(e.id),className:"text-red-600 hover:text-red-900 text-sm",children:"삭제"})]})]}),a.filter(t=>t.parentId===e.id).length>0&&(0,l.jsx)("div",{className:"ml-6 border-l-2 border-gray-200 pl-4",children:O(a.filter(t=>t.parentId===e.id),t+1)})]},e.id))},P=e=>({header:"헤더",footer:"푸터",sidebar:"사이드바"})[e]||e;return(0,l.jsxs)("div",{className:"p-6 max-w-7xl mx-auto",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold",children:"메뉴 관리"}),(0,l.jsx)("button",{onClick:()=>S(),className:"bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600",children:"새 그룹 추가"})]}),i&&(0,l.jsxs)("div",{className:"text-center py-8",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),(0,l.jsx)("p",{className:"mt-2 text-gray-600",children:"로딩 중..."})]}),d&&(0,l.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:d}),!i&&!d&&(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,l.jsx)("div",{className:"lg:col-span-1",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"메뉴 그룹"}),(0,l.jsx)("div",{className:"space-y-2",children:e.map(e=>(0,l.jsx)("div",{className:"p-3 rounded-lg border cursor-pointer transition-colors ".concat((null==s?void 0:s.id)===e.id?"bg-blue-50 border-blue-500":"hover:bg-gray-50"),onClick:()=>r(e),children:(0,l.jsxs)("div",{className:"flex justify-between items-start",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"font-medium",children:e.name}),(0,l.jsx)("div",{className:"text-sm text-gray-500",children:P(e.location)}),(0,l.jsxs)("div",{className:"text-xs text-gray-400",children:[e.items.length,"개 메뉴"]})]}),(0,l.jsxs)("div",{className:"flex flex-col gap-1",children:[!e.isActive&&(0,l.jsx)("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded",children:"비활성"}),(0,l.jsxs)("div",{className:"flex gap-1",children:[(0,l.jsx)("button",{onClick:t=>{t.stopPropagation(),S(e)},className:"text-blue-600 hover:text-blue-900 text-xs",children:"편집"}),(0,l.jsx)("button",{onClick:t=>{t.stopPropagation(),_(e.id)},className:"text-red-600 hover:text-red-900 text-xs",children:"삭제"})]})]})]})},e.id))})]})}),(0,l.jsx)("div",{className:"lg:col-span-3",children:s?(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("h2",{className:"text-lg font-semibold",children:[s.name," 메뉴"]}),(0,l.jsxs)("p",{className:"text-sm text-gray-500",children:[P(s.location)," • ",s.items.length,"개 항목"]})]}),(0,l.jsx)("button",{onClick:()=>C(),className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600",children:"메뉴 추가"})]}),s.items.length>0?(0,l.jsx)("div",{className:"space-y-2",children:O(s.items)}):(0,l.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,l.jsx)("p",{children:"메뉴가 없습니다."}),(0,l.jsx)("button",{onClick:()=>C(),className:"mt-2 text-blue-500 hover:text-blue-700",children:"첫 번째 메뉴 추가하기"})]})]}):(0,l.jsx)("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:(0,l.jsx)("p",{children:"메뉴 그룹을 선택해주세요."})})})]}),o&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("h2",{className:"text-xl font-bold",children:x?"메뉴 편집":"새 메뉴 추가"}),(0,l.jsx)("button",{onClick:()=>m(!1),className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"메뉴명 *"}),(0,l.jsx)("input",{type:"text",value:h.title,onChange:e=>p(t=>({...t,title:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"메뉴 이름"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"URL *"}),(0,l.jsx)("input",{type:"text",value:h.url,onChange:e=>p(t=>({...t,url:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"/about, https://example.com"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"상위 메뉴"}),(0,l.jsxs)("select",{value:h.parentId,onChange:e=>p(t=>({...t,parentId:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,l.jsx)("option",{value:"",children:"없음 (최상위)"}),null==s?void 0:s.items.filter(e=>!e.parentId).map(e=>(0,l.jsx)("option",{value:e.id,children:e.title},e.id))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"순서"}),(0,l.jsx)("input",{type:"number",value:h.order,onChange:e=>p(t=>({...t,order:parseInt(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",min:"1"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"아이콘"}),(0,l.jsx)("input",{type:"text",value:h.icon,onChange:e=>p(t=>({...t,icon:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"\uD83C\uDFE0 (이모지 또는 아이콘 클래스)"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"설명"}),(0,l.jsx)("input",{type:"text",value:h.description,onChange:e=>p(t=>({...t,description:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"메뉴 설명 (선택사항)"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"링크 대상"}),(0,l.jsxs)("select",{value:h.target,onChange:e=>p(t=>({...t,target:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,l.jsx)("option",{value:"_self",children:"같은 창"}),(0,l.jsx)("option",{value:"_blank",children:"새 창"})]})]}),(0,l.jsx)("div",{className:"flex items-center mt-6",children:(0,l.jsxs)("label",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",checked:h.isActive,onChange:e=>p(t=>({...t,isActive:e.target.checked})),className:"mr-2"}),"활성화"]})})]})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,l.jsx)("button",{onClick:()=>m(!1),className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50",disabled:N,children:"취소"}),(0,l.jsx)("button",{onClick:I,disabled:N||!h.title.trim()||!h.url.trim(),className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",children:N?"저장 중...":x?"수정":"추가"})]})]})}),b&&(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,l.jsx)("h2",{className:"text-xl font-bold",children:j?"그룹 편집":"새 그룹 추가"}),(0,l.jsx)("button",{onClick:()=>g(!1),className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"그룹명 *"}),(0,l.jsx)("input",{type:"text",value:y.name,onChange:e=>f(t=>({...t,name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"메뉴 그룹 이름"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"위치"}),(0,l.jsxs)("select",{value:y.location,onChange:e=>f(t=>({...t,location:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,l.jsx)("option",{value:"header",children:"헤더"}),(0,l.jsx)("option",{value:"footer",children:"푸터"}),(0,l.jsx)("option",{value:"sidebar",children:"사이드바"})]})]}),(0,l.jsx)("div",{children:(0,l.jsxs)("label",{className:"flex items-center",children:[(0,l.jsx)("input",{type:"checkbox",checked:y.isActive,onChange:e=>f(t=>({...t,isActive:e.target.checked})),className:"mr-2"}),"활성화"]})})]}),(0,l.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,l.jsx)("button",{onClick:()=>g(!1),className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50",disabled:N,children:"취소"}),(0,l.jsx)("button",{onClick:A,disabled:N||!y.name.trim(),className:"bg-green-500 text-white px-4 py-2 rounded-md hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed",children:N?"저장 중...":j?"수정":"추가"})]})]})})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=8298)}),_N_E=e.O()}]);