(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[229],{1414:function(e,t,s){Promise.resolve().then(s.bind(s,3103))},3103:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return n}});var a=s(7437),r=s(2265),l=s(6538);function n(){let[e,t]=(0,r.useState)([]),[s,n]=(0,r.useState)(1),[d,i]=(0,r.useState)(0),[c,o]=(0,r.useState)(0),[x]=(0,r.useState)(10),[m,h]=(0,r.useState)(!1),[u,p]=(0,r.useState)(""),[g,b]=(0,r.useState)(""),[y,j]=(0,r.useState)(""),[v,f]=(0,r.useState)(""),[N,w]=(0,r.useState)(!1),[k,C]=(0,r.useState)(null),[S,P]=(0,r.useState)({title:"",content:"",summary:"",category:"news",status:"draft",isImportant:!1,isPinned:!1,tags:"",publishedAt:""}),[A,I]=(0,r.useState)(!1),E=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;h(!0),p("");try{let s=new URLSearchParams({page:e.toString(),limit:x.toString(),...g&&{category:g},...y&&{status:y},...v&&{search:v}}),a=await fetch("/api/admin/news?".concat(s)),r=await a.json();r.success?(t(r.data),n(r.pagination.currentPage),i(r.pagination.totalPages),o(r.pagination.totalItems)):p("뉴스 데이터를 불러오는데 실패했습니다.")}catch(e){p("네트워크 오류가 발생했습니다."),console.error("Error fetching news:",e)}finally{h(!1)}};(0,r.useEffect)(()=>{E(s)},[s,g,y,v]);let D=e=>{e?(C(e),P({title:e.title,content:e.content,summary:e.summary||"",category:e.category,status:e.status,isImportant:e.isImportant,isPinned:e.isPinned,tags:e.tags.join(", "),publishedAt:e.publishedAt?new Date(e.publishedAt).toISOString().slice(0,16):""})):(C(null),P({title:"",content:"",summary:"",category:"news",status:"draft",isImportant:!1,isPinned:!1,tags:"",publishedAt:""})),w(!0)},T=async()=>{if(!S.title.trim()||!S.content.trim()){alert("제목과 내용은 필수입니다.");return}I(!0);try{let e={...S,tags:S.tags.split(",").map(e=>e.trim()).filter(e=>e),publishedAt:S.publishedAt||null},t=k?"/api/admin/news/".concat(k.id):"/api/admin/news";(await fetch(t,{method:k?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok?(alert(k?"뉴스가 수정되었습니다.":"뉴스가 추가되었습니다."),w(!1),E(s)):alert("저장 중 오류가 발생했습니다.")}catch(e){console.error("Save error:",e),alert("저장 중 오류가 발생했습니다.")}finally{I(!1)}},O=async e=>{if(confirm("정말 삭제하시겠습니까?"))try{(await fetch("/api/admin/news/".concat(e),{method:"DELETE"})).ok?(alert("뉴스가 삭제되었습니다."),E(s)):alert("삭제 중 오류가 발생했습니다.")}catch(e){console.error("Delete error:",e),alert("삭제 중 오류가 발생했습니다.")}},L=async(e,t)=>{try{(await fetch("/api/admin/news/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})})).ok?E(s):alert("상태 변경에 실패했습니다.")}catch(e){console.error("Status update error:",e),alert("상태 변경 중 오류가 발생했습니다.")}},_=async(e,t,a)=>{try{(await fetch("/api/admin/news/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({[t]:!a})})).ok?E(s):alert("설정 변경에 실패했습니다.")}catch(e){console.error("Toggle error:",e),alert("설정 변경 중 오류가 발생했습니다.")}},M=e=>({style:({news:"bg-blue-100 text-blue-800",notice:"bg-red-100 text-red-800",event:"bg-green-100 text-green-800"})[e],label:({news:"뉴스",notice:"공지사항",event:"이벤트"})[e]}),F=e=>({style:({draft:"bg-gray-100 text-gray-800",published:"bg-green-100 text-green-800",archived:"bg-yellow-100 text-yellow-800"})[e],label:({draft:"임시저장",published:"발행됨",archived:"보관됨"})[e]});return(0,a.jsxs)("div",{className:"p-6 max-w-7xl mx-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"뉴스/공지사항 관리"}),(0,a.jsx)("button",{onClick:()=>D(),className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600",children:"새 글 작성"})]}),(0,a.jsxs)("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"검색"}),(0,a.jsx)("form",{onSubmit:e=>{e.preventDefault(),n(1),E(1)},children:(0,a.jsx)("input",{type:"text",value:v,onChange:e=>f(e.target.value),placeholder:"제목, 내용으로 검색...",className:"w-full px-3 py-2 border border-gray-300 rounded-md"})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"카테고리"}),(0,a.jsxs)("select",{value:g,onChange:e=>{b(e.target.value),n(1)},className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,a.jsx)("option",{value:"",children:"전체"}),(0,a.jsx)("option",{value:"news",children:"뉴스"}),(0,a.jsx)("option",{value:"notice",children:"공지사항"}),(0,a.jsx)("option",{value:"event",children:"이벤트"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"상태"}),(0,a.jsxs)("select",{value:y,onChange:e=>{j(e.target.value),n(1)},className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,a.jsx)("option",{value:"",children:"전체"}),(0,a.jsx)("option",{value:"draft",children:"임시저장"}),(0,a.jsx)("option",{value:"published",children:"발행됨"}),(0,a.jsx)("option",{value:"archived",children:"보관됨"})]})]}),(0,a.jsx)("div",{className:"flex items-end",children:(0,a.jsx)("button",{onClick:()=>E(s),className:"w-full bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600",children:"새로고침"})})]}),m&&(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),(0,a.jsx)("p",{className:"mt-2 text-gray-600",children:"로딩 중..."})]}),u&&(0,a.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:u}),!m&&!u&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"제목"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"카테고리"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"상태"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"설정"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"조회수"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"작성일"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"액션"})]})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,a.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"max-w-xs",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:e.title}),e.summary&&(0,a.jsx)("div",{className:"text-sm text-gray-500 truncate",children:e.summary}),(0,a.jsxs)("div",{className:"text-xs text-gray-400",children:["작성자: ",e.author]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(M(e.category).style),children:M(e.category).label})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("select",{value:e.status,onChange:t=>L(e.id,t.target.value),className:"text-xs border border-gray-300 rounded px-2 py-1 ".concat(F(e.status).style),children:[(0,a.jsx)("option",{value:"draft",children:"임시저장"}),(0,a.jsx)("option",{value:"published",children:"발행됨"}),(0,a.jsx)("option",{value:"archived",children:"보관됨"})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsxs)("label",{className:"flex items-center text-xs",children:[(0,a.jsx)("input",{type:"checkbox",checked:e.isImportant,onChange:()=>_(e.id,"isImportant",e.isImportant),className:"mr-1"}),"중요"]}),(0,a.jsxs)("label",{className:"flex items-center text-xs",children:[(0,a.jsx)("input",{type:"checkbox",checked:e.isPinned,onChange:()=>_(e.id,"isPinned",e.isPinned),className:"mr-1"}),"고정"]})]})}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.viewCount.toLocaleString()}),(0,a.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[new Date(e.createdAt).toLocaleDateString(),e.publishedAt&&(0,a.jsxs)("div",{className:"text-xs text-green-600",children:["발행: ",new Date(e.publishedAt).toLocaleDateString()]})]}),(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)("button",{onClick:()=>D(e),className:"text-blue-600 hover:text-blue-900",children:"편집"}),(0,a.jsx)("button",{onClick:()=>O(e.id),className:"text-red-600 hover:text-red-900",children:"삭제"})]})})]},e.id))})]})}),0===e.length&&(0,a.jsx)("div",{className:"text-center py-12",children:(0,a.jsx)("p",{className:"text-gray-500",children:"뉴스가 없습니다."})}),(0,a.jsx)(l.Z,{currentPage:s,totalPages:d,onPageChange:e=>{n(e)},showInfo:!0,itemsPerPage:x,totalItems:c})]}),N&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold",children:k?"뉴스 편집":"새 글 작성"}),(0,a.jsx)("button",{onClick:()=>w(!1),className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"제목 *"}),(0,a.jsx)("input",{type:"text",value:S.title,onChange:e=>P(t=>({...t,title:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"뉴스 제목"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"카테고리"}),(0,a.jsxs)("select",{value:S.category,onChange:e=>P(t=>({...t,category:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,a.jsx)("option",{value:"news",children:"뉴스"}),(0,a.jsx)("option",{value:"notice",children:"공지사항"}),(0,a.jsx)("option",{value:"event",children:"이벤트"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"요약"}),(0,a.jsx)("input",{type:"text",value:S.summary,onChange:e=>P(t=>({...t,summary:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"간단한 요약 (선택사항)"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"내용 *"}),(0,a.jsx)("textarea",{value:S.content,onChange:e=>P(t=>({...t,content:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",rows:12,placeholder:"뉴스 내용을 입력하세요"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"태그"}),(0,a.jsx)("input",{type:"text",value:S.tags,onChange:e=>P(t=>({...t,tags:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"태그1, 태그2, 태그3 (쉼표로 구분)"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"발행일시"}),(0,a.jsx)("input",{type:"datetime-local",value:S.publishedAt,onChange:e=>P(t=>({...t,publishedAt:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium mb-1",children:"상태"}),(0,a.jsxs)("select",{value:S.status,onChange:e=>P(t=>({...t,status:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,a.jsx)("option",{value:"draft",children:"임시저장"}),(0,a.jsx)("option",{value:"published",children:"발행"}),(0,a.jsx)("option",{value:"archived",children:"보관"})]})]}),(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:S.isImportant,onChange:e=>P(t=>({...t,isImportant:e.target.checked})),className:"mr-2"}),"중요 뉴스"]})}),(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsxs)("label",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:S.isPinned,onChange:e=>P(t=>({...t,isPinned:e.target.checked})),className:"mr-2"}),"상단 고정"]})})]})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,a.jsx)("button",{onClick:()=>w(!1),className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50",disabled:A,children:"취소"}),(0,a.jsx)("button",{onClick:T,disabled:A||!S.title.trim()||!S.content.trim(),className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",children:A?"저장 중...":k?"수정":"작성"})]})]})})]})}},6538:function(e,t,s){"use strict";s.d(t,{Z:function(){return l}});var a=s(7437),r=s(2265);function l(e){let{currentPage:t,totalPages:s,onPageChange:l,showInfo:n=!0,itemsPerPage:d=10,totalItems:i=0}=e,[c,o]=(0,r.useState)([]);(0,r.useEffect)(()=>{o((()=>{let e=[];if(s<=5)for(let t=1;t<=s;t++)e.push(t);else{let a=Math.max(1,t-Math.floor(2.5)),r=Math.min(s,a+5-1);r-a+1<5&&(a=Math.max(1,r-5+1));for(let t=a;t<=r;t++)e.push(t)}return e})())},[t,s]);let x=e=>{e>=1&&e<=s&&e!==t&&l(e)};return s<=1?null:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4 mt-6",children:[n&&(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:["페이지 ",t," / ",s,i>0&&(0,a.jsxs)("span",{className:"ml-2",children:["(총 ",i.toLocaleString(),"개 항목, 페이지당 ",d,"개)"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("button",{onClick:()=>{1!==t&&l(1)},disabled:1===t,className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"첫 페이지",children:"\xab\xab"}),(0,a.jsx)("button",{onClick:()=>{t>1&&l(t-1)},disabled:1===t,className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"이전 페이지",children:"‹"}),c.length>0&&c[0]>1&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>x(1),className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50",children:"1"}),c[0]>2&&(0,a.jsx)("span",{className:"px-2 py-2 text-sm text-gray-400",children:"..."})]}),c.map(e=>(0,a.jsx)("button",{onClick:()=>x(e),className:"px-3 py-2 text-sm border rounded-md ".concat(e===t?"bg-blue-500 text-white border-blue-500":"border-gray-300 hover:bg-gray-50"),children:e},e)),c.length>0&&c[c.length-1]<s&&(0,a.jsxs)(a.Fragment,{children:[c[c.length-1]<s-1&&(0,a.jsx)("span",{className:"px-2 py-2 text-sm text-gray-400",children:"..."}),(0,a.jsx)("button",{onClick:()=>x(s),className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50",children:s})]}),(0,a.jsx)("button",{onClick:()=>{t<s&&l(t+1)},disabled:t===s,className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"다음 페이지",children:"›"}),(0,a.jsx)("button",{onClick:()=>{t!==s&&l(s)},disabled:t===s,className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"마지막 페이지",children:"\xbb\xbb"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,a.jsx)("span",{children:"페이지 이동:"}),(0,a.jsx)("input",{type:"number",min:"1",max:s,className:"w-16 px-2 py-1 border border-gray-300 rounded text-center",onKeyDown:e=>{if("Enter"===e.key){let t=parseInt(e.target.value);t>=1&&t<=s&&(x(t),e.target.value="")}},placeholder:t.toString()}),(0,a.jsxs)("span",{children:["/ ",s]})]})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=1414)}),_N_E=e.O()}]);