(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[824],{5459:function(e,t,a){Promise.resolve().then(a.bind(a,914))},914:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return n}});var s=a(7437),r=a(2265),l=a(6538);function n(){let[e,t]=(0,r.useState)([]),[a,n]=(0,r.useState)(1),[d,i]=(0,r.useState)(0),[c,o]=(0,r.useState)(0),[x]=(0,r.useState)(10),[m,u]=(0,r.useState)(!1),[h,p]=(0,r.useState)(""),[g,b]=(0,r.useState)(""),[y,j]=(0,r.useState)(""),[v,f]=(0,r.useState)(""),[N,w]=(0,r.useState)(!1),[k,C]=(0,r.useState)(null),[S,P]=(0,r.useState)({name:"",email:"",phone:"",role:"user",status:"active"}),[E,D]=(0,r.useState)(!1),[L,T]=(0,r.useState)(!1),_=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;u(!0),p("");try{let a=new URLSearchParams({page:e.toString(),limit:x.toString(),...g&&{role:g},...y&&{status:y},...v&&{search:v}}),s=await fetch("/api/admin/users?".concat(a)),r=await s.json();r.success?(t(r.data),n(r.pagination.currentPage),i(r.pagination.totalPages),o(r.pagination.totalItems)):p("사용자 데이터를 불러오는데 실패했습니다.")}catch(e){p("네트워크 오류가 발생했습니다."),console.error("Error fetching users:",e)}finally{u(!1)}};(0,r.useEffect)(()=>{_(a)},[a,g,y,v]);let O=e=>{C(e),P({name:e.name,email:e.email,phone:e.phone||"",role:e.role,status:e.status}),w(!0)},I=async()=>{if(!S.name.trim()||!S.email.trim()){alert("이름과 이메일은 필수입니다.");return}D(!0);try{let e=k?"/api/admin/users/".concat(k.id):"/api/admin/users";(await fetch(e,{method:k?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)})).ok?(alert(k?"사용자가 수정되었습니다.":"사용자가 추가되었습니다."),w(!1),T(!1),_(a)):alert("저장 중 오류가 발생했습니다.")}catch(e){console.error("Save error:",e),alert("저장 중 오류가 발생했습니다.")}finally{D(!1)}},M=async e=>{if(confirm("정말 삭제하시겠습니까?"))try{(await fetch("/api/admin/users/".concat(e),{method:"DELETE"})).ok?(alert("사용자가 삭제되었습니다."),_(a)):alert("삭제 중 오류가 발생했습니다.")}catch(e){console.error("Delete error:",e),alert("삭제 중 오류가 발생했습니다.")}},A=async(e,t)=>{try{(await fetch("/api/admin/users/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})})).ok?_(a):alert("상태 변경에 실패했습니다.")}catch(e){console.error("Status update error:",e),alert("상태 변경 중 오류가 발생했습니다.")}},F=e=>({style:({active:"bg-green-100 text-green-800",inactive:"bg-gray-100 text-gray-800",suspended:"bg-red-100 text-red-800"})[e],label:({active:"활성",inactive:"비활성",suspended:"정지"})[e]}),U=e=>({style:({admin:"bg-purple-100 text-purple-800",editor:"bg-blue-100 text-blue-800",user:"bg-gray-100 text-gray-800"})[e],label:({admin:"관리자",editor:"편집자",user:"사용자"})[e]});return(0,s.jsxs)("div",{className:"p-6 max-w-7xl mx-auto",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"사용자 관리"}),(0,s.jsx)("button",{onClick:()=>{C(null),P({name:"",email:"",phone:"",role:"user",status:"active"}),T(!0)},className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600",children:"새 사용자 추가"})]}),(0,s.jsxs)("div",{className:"mb-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"검색"}),(0,s.jsx)("form",{onSubmit:e=>{e.preventDefault(),n(1),_(1)},children:(0,s.jsx)("input",{type:"text",value:v,onChange:e=>f(e.target.value),placeholder:"이름, 이메일로 검색...",className:"w-full px-3 py-2 border border-gray-300 rounded-md"})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"역할"}),(0,s.jsxs)("select",{value:g,onChange:e=>{b(e.target.value),n(1)},className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,s.jsx)("option",{value:"",children:"전체"}),(0,s.jsx)("option",{value:"admin",children:"관리자"}),(0,s.jsx)("option",{value:"editor",children:"편집자"}),(0,s.jsx)("option",{value:"user",children:"사용자"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"상태"}),(0,s.jsxs)("select",{value:y,onChange:e=>{j(e.target.value),n(1)},className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,s.jsx)("option",{value:"",children:"전체"}),(0,s.jsx)("option",{value:"active",children:"활성"}),(0,s.jsx)("option",{value:"inactive",children:"비활성"}),(0,s.jsx)("option",{value:"suspended",children:"정지"})]})]}),(0,s.jsx)("div",{className:"flex items-end",children:(0,s.jsx)("button",{onClick:()=>_(a),className:"w-full bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600",children:"새로고침"})})]}),m&&(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),(0,s.jsx)("p",{className:"mt-2 text-gray-600",children:"로딩 중..."})]}),h&&(0,s.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:h}),!m&&!h&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"사용자"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"역할"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"상태"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"마지막 로그인"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"가입일"}),(0,s.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"액션"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,s.jsx)("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e.name.charAt(0).toUpperCase()})})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:e.email}),e.phone&&(0,s.jsx)("div",{className:"text-sm text-gray-500",children:e.phone})]})]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat(U(e.role).style),children:U(e.role).label})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("select",{value:e.status,onChange:t=>A(e.id,t.target.value),className:"text-xs border border-gray-300 rounded px-2 py-1 ".concat(F(e.status).style),children:[(0,s.jsx)("option",{value:"active",children:"활성"}),(0,s.jsx)("option",{value:"inactive",children:"비활성"}),(0,s.jsx)("option",{value:"suspended",children:"정지"})]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.lastLogin?new Date(e.lastLogin).toLocaleString():"로그인 기록 없음"}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(e.createdAt).toLocaleDateString()}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,s.jsx)("button",{onClick:()=>O(e),className:"text-blue-600 hover:text-blue-900",children:"편집"}),(0,s.jsx)("button",{onClick:()=>M(e.id),className:"text-red-600 hover:text-red-900",children:"삭제"})]})})]},e.id))})]})}),0===e.length&&(0,s.jsx)("div",{className:"text-center py-12",children:(0,s.jsx)("p",{className:"text-gray-500",children:"사용자가 없습니다."})}),(0,s.jsx)(l.Z,{currentPage:a,totalPages:d,onPageChange:e=>{n(e)},showInfo:!0,itemsPerPage:x,totalItems:c})]}),(N||L)&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsx)("h2",{className:"text-xl font-bold",children:k?"사용자 편집":"새 사용자 추가"}),(0,s.jsx)("button",{onClick:()=>{w(!1),T(!1)},className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"이름 *"}),(0,s.jsx)("input",{type:"text",value:S.name,onChange:e=>P(t=>({...t,name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"사용자 이름"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"이메일 *"}),(0,s.jsx)("input",{type:"email",value:S.email,onChange:e=>P(t=>({...t,email:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"이메일 주소"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"전화번호"}),(0,s.jsx)("input",{type:"tel",value:S.phone,onChange:e=>P(t=>({...t,phone:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",placeholder:"전화번호"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"역할"}),(0,s.jsxs)("select",{value:S.role,onChange:e=>P(t=>({...t,role:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,s.jsx)("option",{value:"user",children:"사용자"}),(0,s.jsx)("option",{value:"editor",children:"편집자"}),(0,s.jsx)("option",{value:"admin",children:"관리자"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium mb-1",children:"상태"}),(0,s.jsxs)("select",{value:S.status,onChange:e=>P(t=>({...t,status:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[(0,s.jsx)("option",{value:"active",children:"활성"}),(0,s.jsx)("option",{value:"inactive",children:"비활성"}),(0,s.jsx)("option",{value:"suspended",children:"정지"})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,s.jsx)("button",{onClick:()=>{w(!1),T(!1)},className:"px-4 py-2 border border-gray-300 rounded-md hover:bg-gray-50",disabled:E,children:"취소"}),(0,s.jsx)("button",{onClick:I,disabled:E||!S.name.trim()||!S.email.trim(),className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",children:E?"저장 중...":k?"수정":"추가"})]})]})})]})}},6538:function(e,t,a){"use strict";a.d(t,{Z:function(){return l}});var s=a(7437),r=a(2265);function l(e){let{currentPage:t,totalPages:a,onPageChange:l,showInfo:n=!0,itemsPerPage:d=10,totalItems:i=0}=e,[c,o]=(0,r.useState)([]);(0,r.useEffect)(()=>{o((()=>{let e=[];if(a<=5)for(let t=1;t<=a;t++)e.push(t);else{let s=Math.max(1,t-Math.floor(2.5)),r=Math.min(a,s+5-1);r-s+1<5&&(s=Math.max(1,r-5+1));for(let t=s;t<=r;t++)e.push(t)}return e})())},[t,a]);let x=e=>{e>=1&&e<=a&&e!==t&&l(e)};return a<=1?null:(0,s.jsxs)("div",{className:"flex flex-col items-center gap-4 mt-6",children:[n&&(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:["페이지 ",t," / ",a,i>0&&(0,s.jsxs)("span",{className:"ml-2",children:["(총 ",i.toLocaleString(),"개 항목, 페이지당 ",d,"개)"]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("button",{onClick:()=>{1!==t&&l(1)},disabled:1===t,className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"첫 페이지",children:"\xab\xab"}),(0,s.jsx)("button",{onClick:()=>{t>1&&l(t-1)},disabled:1===t,className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"이전 페이지",children:"‹"}),c.length>0&&c[0]>1&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("button",{onClick:()=>x(1),className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50",children:"1"}),c[0]>2&&(0,s.jsx)("span",{className:"px-2 py-2 text-sm text-gray-400",children:"..."})]}),c.map(e=>(0,s.jsx)("button",{onClick:()=>x(e),className:"px-3 py-2 text-sm border rounded-md ".concat(e===t?"bg-blue-500 text-white border-blue-500":"border-gray-300 hover:bg-gray-50"),children:e},e)),c.length>0&&c[c.length-1]<a&&(0,s.jsxs)(s.Fragment,{children:[c[c.length-1]<a-1&&(0,s.jsx)("span",{className:"px-2 py-2 text-sm text-gray-400",children:"..."}),(0,s.jsx)("button",{onClick:()=>x(a),className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50",children:a})]}),(0,s.jsx)("button",{onClick:()=>{t<a&&l(t+1)},disabled:t===a,className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"다음 페이지",children:"›"}),(0,s.jsx)("button",{onClick:()=>{t!==a&&l(a)},disabled:t===a,className:"px-3 py-2 text-sm border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",title:"마지막 페이지",children:"\xbb\xbb"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)("span",{children:"페이지 이동:"}),(0,s.jsx)("input",{type:"number",min:"1",max:a,className:"w-16 px-2 py-1 border border-gray-300 rounded text-center",onKeyDown:e=>{if("Enter"===e.key){let t=parseInt(e.target.value);t>=1&&t<=a&&(x(t),e.target.value="")}},placeholder:t.toString()}),(0,s.jsxs)("span",{children:["/ ",a]})]})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=5459)}),_N_E=e.O()}]);